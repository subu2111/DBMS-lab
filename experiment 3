CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(255),
    CustomerAddress VARCHAR(255),
    Country VARCHAR(255)
);

INSERT INTO Customers (CustomerID, CustomerName,CustomerAddress, Country)
VALUES(1,'Alice Smith','123 Main st,Anytown' ,'USA'),
       (2,'Bob johnson','456 Elm st,Othertown','USA'),
       (3,'Charlie Brown','789 Oak st,Thirdtown','Canada');


CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    OrderDate DATE,
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);

INSERT INTO Orders (OrderID, CustomerID, OrderDate)
VALUES (101,1,'2023-10-15'),
       (102,1,'2023-10-16'),
       (103,2,'2023-10-17');

CREATE TABLE PreferredCustomers (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(255),
    DiscountPercentage INT
);

INSERT INTO PreferredCustomers (CustomerID, CustomerName,DiscountPercentage)
VALUES (201, 'Eva WilliamS', 10),
       (202, 'David Lee',15),
       (203, 'Fiona Clark', 20);
       

SELECT Customers.CustomerName, Orders.OrderID, Orders.OrderDate
FROM Customers
INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID;

SELECT COUNT(*)
FROM Orders
WHERE CustomerID IN (
    SELECT CustomerID
    FROM Customers
    WHERE CustomerName LIKE 'A%'
);

SELECT CustomerName
FROM Customers
UNION
SELECT CustomerName
FROM PreferredCustomers;


SELECT CustomerName
FROM Customers
WHERE CustomerID IN (
    SELECT CustomerID
    FROM Orders
)
INTERSECT
SELECT CustomerName
FROM Customers;


SELECT CustomerName
FROM Customers
WHERE CustomerID IN (
    SELECT CustomerID
    FROM Orders
)
EXCEPT
SELECT CustomerName
FROM Customers;

